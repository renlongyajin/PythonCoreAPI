# 下一步开发计划

## 阶段一：Python 后端基础
1. **环境与依赖初始化**：
   - 先编写脚本/测试验证 Python 版本、虚拟环境与依赖安装（`poetry` 或 `pipenv`）是否成功。
   - 搭建 `.env.example`、`pyproject.toml/requirements.txt`，并通过 CI 运行 `python -m pytest --help` 验证环境可用。
2. **FastAPI 骨架 + 健康检查**：
   - 编写 `/health` API 的 Pytest 用例，覆盖状态码与依赖注入行为。
   - 实现 `main.py`、配置加载、`/health` 路由及基础中间件。
3. **数据库与配置层**：
   - 先写 Session/Settings 的单元测试，验证连接字符串生成、事务上下文管理。
   - 实现 SQLAlchemy Base、Session 管理、Alembic 配置与 `.env` 读取。
4. **用户与角色模型**：
   - 以测试驱动方式编写 Repository 行为测试，覆盖 CRUD 与角色绑定。
   - 实现 `User`/`Role` 模型、仓储接口与基础迁移。
5. **认证 API（已完成）**：
   - 完成注册/登录/刷新/`/me` 的测试与实现，作为后续开发基线。

## 阶段二：法规与检索能力
1. **Alembic 迁移与种子数据**：
   - 创建初始迁移，覆盖 users/roles/user_roles 表；提供示例数据脚本，确保部署一致性。
2. **法规 CRUD API**：
   - 按 TDD 编写 `laws` 模块的 Repository + Router 测试，实现法规、章节、条文的创建与查询。
3. **法规导入与切分任务**：
   - 设计批量导入接口与 Celery 任务，实现文档解析、切分、向量入库 Pipeline。
4. **检索接口**：
   - 为 `/api/v1/retrieval/search` 编写测试，完成基于 pgvector 的向量检索与排序。
5. **问答编排（RAG）**：
   - 编写 `QAService` 测试，串联检索 + LLM 客户端，输出引用 + 分析。
6. **运维与监控**：
   - 配置日志、指标、健康检查扩展；根据需要增加限流、告警与 CI/CD 流程。
